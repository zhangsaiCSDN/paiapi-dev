<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="../../layuiadmin/layui/css/layui.css"
	media="all">
<link rel="stylesheet" href="../../layuiadmin/style/admin.css"
	media="all">
<script src="https://cdn.bootcss.com/vue/2.6.10/vue.min.js"></script>
<script src="https://cdn.bootcss.com/axios/0.19.0/axios.min.js"></script>
<link href="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
	
	<table id="app" class="table table-hover table-striped table-bordered table-dark" lay-skin="line">
		<thead>
			<tr>
				<th>用户名</th>
				<th>保证金金额</th>
				<th>状态</th>
				<th>所属拍品</th>
				<th>操作</th>
			</tr>
		</thead>
		<tbody>
			<tr v-for="deposit in deposits.list">
			
				<td>{{deposit.user.uname}}</td>
				<td>{{deposit.dmoney}}</td>
				<td>{{deposit.gstate}}</td>
				<td>{{deposit.goods.gname}}</td>
				<td>
					<button @click='del(deposit.did)' type="button" class="btn btn-warning" >删除</button> 
					<button @click='edit' type="button" class="btn btn-danger">编辑</button>
				</td> 
			</tr>
			<tr>
				<th colspan="5">
				{{deposits.p}}/{{deposits.maxPage}}
				<button @click='find(1)' class="btn btn-outline-info">首页</button>
				<button @click='find(deposits.prev)' class="btn btn-outline-info">上一页</button>
				
				<button @click='find(deposits.next)' class="btn btn-outline-info">下一页</button>
				<button @click='find(deposits.maxPage)' class="btn btn-outline-info">末页</button>
				</th>
			</tr>
		</tbody>
	</table>
</body>
<script>
	var vue = new Vue({
		el : "#app",
		data : {
			deposits : [],
			
		},
		created: function(){ 
			this.find(1);
		},
		methods:{
			find(page){
				var self = this
				axios.get("http://localhost:8080/deposits",{
						params:{
							p:page
						}
				}	
				).then(
						function(response) {
							self.deposits = response.data; //此时还是字符串
							// self.deposits = eval("(" + self.deposits + ")"); //字符串转换为数组对象
				})
			},
			
			del(did1){
				var self=this
				axios.delete("http://localhost:8080/deposits",{
					params:{
						did:did1
					}
				}).then(function(){
					self.find(self.deposits.p)
				})
			},
			edit(){} 
		}
	});
</script>
</html>