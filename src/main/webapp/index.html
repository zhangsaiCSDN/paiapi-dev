<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<link
	href="https://cdn.bootcss.com/twitter-bootstrap/4.3.1/css/bootstrap.css"
	rel="stylesheet">


<style type="text/css">
#update, #del {
	width: 50%;
}

th {
	text-align: center;
}
</style>
</head>

<body>
	<center>
		<h1>用户管理系统</h1>
	</center>




	

	<table
		class="table table-hover table-striped table-bordered table-dark">
		<tr>
			<th>用户编号</th>
			<th>用户名称</th>
			<th>生日</th>
			<th>工资</th>
			<th>操作</th>

		</tr>


	</table>
	
	
</body>
</html>
<script type="text/javascript">
	$(function() {

		
		function updateTable() {
			$
					.ajax({
						type : "get",
						url : "/users",
						headers : {
							"Accept" : "application/json"
						},
						success : function(data) {
							var tab = $("table:eq(0)");
							for (p in data) {
								/*  alert(data[p].eid+" "+data[p].ename+" "+data[p].birthday+" "+data[p].money);  */
								var tr = $("<tr>");
								var th = $("<th>");
								var th2 = $("<th>");
								var th3 = $("<th>");
								var th4 = $("<th>");
								var th5 = $("<th>");
								th.append(data[p].uid);
								th2.append(data[p].uname);
								th3.append(data[p].birthday);
								th4.append(data[p].money);

								var update = $("<button id='update' type='button' class='btn btn-warning'>修改</button>");
								var del = $("<button  id='del' type='button'  onclick='del'  class='btn btn-danger'>删除 </button>");
								
								del.click(function(){
									
									alert(data[p].uid);
									
									
									
									
									
									var uid=$(this).parent().parent().children().eq(0).html();
									
									
									$.ajax({
										
										type:"post",
										url:"/users",
										data:{"uid":uid,"_method":"delete"},
										success:function(){
												
											updataTable();
										}
										
									});
									
								
									});
									
									
								th5.append(update, del);

								tr.append(th);
								tr.append(th2);
								tr.append(th3);
								tr.append(th4);
								tr.append(th5);
								tab.append(tr);

							}
						}
					});

		}
		
		updateTable();

	});
</script>